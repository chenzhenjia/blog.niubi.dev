<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>安装了magisk的pixel4xl升级到安卓13 - 陈</title><meta name=Description content="陈"><meta property="og:title" content="安装了magisk的pixel4xl升级到安卓13"><meta property="og:description" content="原因 我的pxiel4xl在线升级安卓13的时候报升级出错，后来找了一下原因，是因为系统更新（OTA）更新的时候，会检测验证system分区是否完整，如果被修改，则会导致更新失败，所以在下载的时候直接提示安装失败。刷Magisk时修改了boot.img这个system分区的文件，所以刷Magisk后不能直接安装OTA更新。
解决方法 准备工作 先关闭开发者设置中的系统自动更新 先卸载magisk 打开Magisk 点击卸载Magisk 点击弹出窗口的还原原厂镜像 还原远程镜像会可能会提示 stock backup does not exist 原厂镜像备份不存在 解决原厂镜像不存在的问题 如果还原成功不需要进行该操作
在设置里面打开关于手机->版本号
我在这里的版本号就是 221005.002 ，你需要注意你的安装版本号
下载对应的镜像
下载网页
找到你手机对应的版本号下载
解压boot.img
在下载好的压缩包找到 image- 开头的压缩包 再从这个image-开头的压缩包里面提取boot.img
制作准备还原的boot.img
在电脑上push boot.img到手机上 adb push boot.img /sdcard/boot.img 进入adb shell adb shell su 分别执行一下命令 SHA1=$(cat $(magisk --path)/.magisk/config | grep SHA1 | cut -d '=' -f 2) gzip -9f /sdcard/boot.img mkdir /data/magisk_backup_${SHA1} mv /sdcard/boot.img.gz /data/magisk_backup_${SHA1}/boot.img.gz chmod -R 755 /data/magisk_backup_${SHA1} chown -R root.root /data/magisk_backup_${SHA1} 上面的操作都成功了就可以了"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.niubi.dev/posts/%E5%AE%89%E8%A3%85%E4%BA%86magisk%E7%9A%84pixel4xl%E5%8D%87%E7%BA%A7%E5%88%B0%E5%AE%89%E5%8D%9313/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-12T14:25:00+08:00"><meta property="article:modified_time" content="2022-10-12T14:25:00+08:00"><meta property="og:site_name" content="陈"><meta name=twitter:card content="summary"><meta name=twitter:title content="安装了magisk的pixel4xl升级到安卓13"><meta name=twitter:description content="原因 我的pxiel4xl在线升级安卓13的时候报升级出错，后来找了一下原因，是因为系统更新（OTA）更新的时候，会检测验证system分区是否完整，如果被修改，则会导致更新失败，所以在下载的时候直接提示安装失败。刷Magisk时修改了boot.img这个system分区的文件，所以刷Magisk后不能直接安装OTA更新。
解决方法 准备工作 先关闭开发者设置中的系统自动更新 先卸载magisk 打开Magisk 点击卸载Magisk 点击弹出窗口的还原原厂镜像 还原远程镜像会可能会提示 stock backup does not exist 原厂镜像备份不存在 解决原厂镜像不存在的问题 如果还原成功不需要进行该操作
在设置里面打开关于手机->版本号
我在这里的版本号就是 221005.002 ，你需要注意你的安装版本号
下载对应的镜像
下载网页
找到你手机对应的版本号下载
解压boot.img
在下载好的压缩包找到 image- 开头的压缩包 再从这个image-开头的压缩包里面提取boot.img
制作准备还原的boot.img
在电脑上push boot.img到手机上 adb push boot.img /sdcard/boot.img 进入adb shell adb shell su 分别执行一下命令 SHA1=$(cat $(magisk --path)/.magisk/config | grep SHA1 | cut -d '=' -f 2) gzip -9f /sdcard/boot.img mkdir /data/magisk_backup_${SHA1} mv /sdcard/boot.img.gz /data/magisk_backup_${SHA1}/boot.img.gz chmod -R 755 /data/magisk_backup_${SHA1} chown -R root.root /data/magisk_backup_${SHA1} 上面的操作都成功了就可以了"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.niubi.dev/posts/%E5%AE%89%E8%A3%85%E4%BA%86magisk%E7%9A%84pixel4xl%E5%8D%87%E7%BA%A7%E5%88%B0%E5%AE%89%E5%8D%9313/><link rel=prev href=https://blog.niubi.dev/posts/springboot%E9%85%8D%E7%BD%AEvuejs%E6%88%96%E8%80%85react%E7%9A%84history%E8%B7%AF%E7%94%B1/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"安装了magisk的pixel4xl升级到安卓13","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.niubi.dev\/posts\/%E5%AE%89%E8%A3%85%E4%BA%86magisk%E7%9A%84pixel4xl%E5%8D%87%E7%BA%A7%E5%88%B0%E5%AE%89%E5%8D%9313\/"},"genre":"posts","wordcount":138,"url":"https:\/\/blog.niubi.dev\/posts\/%E5%AE%89%E8%A3%85%E4%BA%86magisk%E7%9A%84pixel4xl%E5%8D%87%E7%BA%A7%E5%88%B0%E5%AE%89%E5%8D%9313\/","datePublished":"2022-10-12T14:25:00+08:00","dateModified":"2022-10-12T14:25:00+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"陈"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=陈>陈</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=陈>陈</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">安装了magisk的pixel4xl升级到安卓13</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>陈</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-10-12>2022-10-12</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 138 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 1 分钟&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#原因>原因</a></li><li><a href=#解决方法>解决方法</a><ul><li><a href=#准备工作>准备工作</a></li><li><a href=#先卸载magisk>先卸载magisk</a></li><li><a href=#解决原厂镜像不存在的问题>解决原厂镜像不存在的问题</a></li><li><a href=#升级系统>升级系统</a></li><li><a href=#升级系统后不重启安装magisk>升级系统后不重启安装magisk</a></li><li><a href=#卸载magisk还是不能升级系统操作>卸载magisk还是不能升级系统操作</a></li><li><a href=#执行-fastboot-一直在wait-device解决>执行 fastboot 一直在wait device解决</a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=原因>原因</h2><p>我的pxiel4xl在线升级安卓13的时候报升级出错，后来找了一下原因，是因为系统更新（OTA）更新的时候，会检测验证system分区是否完整，如果被修改，则会导致更新失败，所以在下载的时候直接提示安装失败。刷Magisk时修改了boot.img这个system分区的文件，所以刷Magisk后不能直接安装OTA更新。</p><h2 id=解决方法>解决方法</h2><h3 id=准备工作>准备工作</h3><ol><li>先关闭开发者设置中的系统自动更新
<img class=lazyload src=/svg/loading.min.svg data-src=/images/pixel-4xl-devlper-settings-xxxxxxx.png data-srcset="/images/pixel-4xl-devlper-settings-xxxxxxx.png, /images/pixel-4xl-devlper-settings-xxxxxxx.png 1.5x, /images/pixel-4xl-devlper-settings-xxxxxxx.png 2x" data-sizes=auto alt=/images/pixel-4xl-devlper-settings-xxxxxxx.png title=/images/pixel-4xl-devlper-settings-xxxxxxx.png></li></ol><h3 id=先卸载magisk>先卸载magisk</h3><ol><li>打开Magisk</li><li>点击卸载Magisk</li><li>点击弹出窗口的还原原厂镜像
还原远程镜像会可能会提示 <code>stock backup does not exist</code> <code>原厂镜像备份不存在</code></li></ol><h3 id=解决原厂镜像不存在的问题>解决原厂镜像不存在的问题</h3><blockquote><p>如果还原成功不需要进行该操作</p></blockquote><ol><li><p>在设置里面打开关于手机->版本号</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/pixel-4xl-about-device.jpg data-srcset="/images/pixel-4xl-about-device.jpg, /images/pixel-4xl-about-device.jpg 1.5x, /images/pixel-4xl-about-device.jpg 2x" data-sizes=auto alt=/images/pixel-4xl-about-device.jpg title=关于手机></p><blockquote><p>我在这里的版本号就是 221005.002 ，你需要注意你的安装版本号</p></blockquote></li><li><p>下载对应的镜像</p><p><a href=https://developers.google.com/android/images#coral target=_blank rel="noopener noreffer">下载网页</a></p><blockquote><p>找到你手机对应的版本号下载</p></blockquote></li><li><p>解压boot.img</p><p>在下载好的压缩包找到 image- 开头的压缩包
再从这个image-开头的压缩包里面提取boot.img</p></li><li><p>制作准备还原的boot.img</p><ol><li>在电脑上push boot.img到手机上</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>adb push boot.img /sdcard/boot.img
</span></span></code></pre></div><ol start=2><li>进入adb shell</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>adb shell
</span></span><span class=line><span class=cl>su
</span></span></code></pre></div><ol start=3><li>分别执行一下命令</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>SHA1</span><span class=o>=</span><span class=k>$(</span>cat <span class=k>$(</span>magisk --path<span class=k>)</span>/.magisk/config <span class=p>|</span> grep SHA1 <span class=p>|</span> cut -d <span class=s1>&#39;=&#39;</span> -f 2<span class=k>)</span>
</span></span><span class=line><span class=cl>gzip -9f /sdcard/boot.img
</span></span><span class=line><span class=cl>mkdir /data/magisk_backup_<span class=si>${</span><span class=nv>SHA1</span><span class=si>}</span>
</span></span><span class=line><span class=cl>mv /sdcard/boot.img.gz /data/magisk_backup_<span class=si>${</span><span class=nv>SHA1</span><span class=si>}</span>/boot.img.gz
</span></span><span class=line><span class=cl>chmod -R <span class=m>755</span> /data/magisk_backup_<span class=si>${</span><span class=nv>SHA1</span><span class=si>}</span>
</span></span><span class=line><span class=cl>chown -R root.root /data/magisk_backup_<span class=si>${</span><span class=nv>SHA1</span><span class=si>}</span>
</span></span></code></pre></div><p>上面的操作都成功了就可以了</p></li></ol><h3 id=升级系统>升级系统</h3><p>再次重试升级系统，如果这个时候还是报升级失败的话，只能重启系统后再升级
但是如果已经可以升级了就直接升级，升级完成后<strong>千万别重启</strong>，</p><h3 id=升级系统后不重启安装magisk>升级系统后不重启安装magisk</h3><ol><li>打开magisk -> 安装 -> 安装到未使用的槽位，然后重启
<img class=lazyload src=/svg/loading.min.svg data-src=/images/magisk-install-xxxx.jpg data-srcset="/images/magisk-install-xxxx.jpg, /images/magisk-install-xxxx.jpg 1.5x, /images/magisk-install-xxxx.jpg 2x" data-sizes=auto alt=/images/magisk-install-xxxx.jpg title=/images/magisk-install-xxxx.jpg></li></ol><h3 id=卸载magisk还是不能升级系统操作>卸载magisk还是不能升级系统操作</h3><blockquote><p>一下步骤其实就是重新刷入magisk</p></blockquote><ol><li>重启magisk</li><li>进入系统后确认一下magisk是否安装，如果未安装可以进行一下步骤</li><li>直接点击升级系统（如果还是不行就不确定是什么问题了，有没有可能是boot.img 不正确之类的）
等待升级完成，重启系统</li><li>下载新系统对应的镜像<ol><li>进入关于手机查看系统版本</li><li>还是在这个网页下载系统对应的镜像
<a href=https://developers.google.com/android/images#coral target=_blank rel="noopener noreffer">下载网页</a></li></ol></li><li>解压出boot.img</li><li>上传boot.img到手机<div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>adb push boot.img /sdcard/Download/boot.img
</span></span></code></pre></div></li><li>打开Magisk Manager安装程序</li><li>制作 Magisk镜像
安装 -> 选择 选择并修复一个文件-> 刚刚push到手机上的boot.img
等待执行完成会告诉你文件名</li><li>pull 镜像到电脑上<div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>adb pull /sdcard/Download/magisk_pathced_xxx.img ./
</span></span></code></pre></div></li><li>在电脑上刷入magisk<div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>fastboot flash boot /xx/xx/magisk_pathced_xxx.img
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>fastboot reboot
</span></span></code></pre></div></li></ol><h3 id=执行-fastboot-一直在wait-device解决>执行 fastboot 一直在wait device解决</h3><p>需要下载安装的usb 驱动并安装才可以</p><ol><li>下载驱动
<a href=https://dl-ssl.google.com/android/repository/latest_usb_driver_windows.zip target=_blank rel="noopener noreffer">latest_usb_driver_windows 下载链接</a></li><li>解压到文件</li><li>打开设备管理
<img class=lazyload src=/svg/loading.min.svg data-src=/images/2022-10-13_11-00-27.png data-srcset="/images/2022-10-13_11-00-27.png, /images/2022-10-13_11-00-27.png 1.5x, /images/2022-10-13_11-00-27.png 2x" data-sizes=auto alt=/images/2022-10-13_11-00-27.png title=/images/2022-10-13_11-00-27.png></li><li>选择刚才解压的usb驱动的文件夹确认安装</li></ol><blockquote><p>再次执行 fastboot flash boot 就可以了</p></blockquote></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-10-12</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/springboot%E9%85%8D%E7%BD%AEvuejs%E6%88%96%E8%80%85react%E7%9A%84history%E8%B7%AF%E7%94%B1/ class=prev rel=prev title=SpringBoot配置VueJs或者React的history路由><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>SpringBoot配置VueJs或者React的history路由</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5524310624522502" crossorigin=anonymous></script></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>陈</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-P341M2MLW1",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-P341M2MLW1" async></script></body></html>