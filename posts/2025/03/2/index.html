<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>使用qcow2镜像安装debian后扩容 - 陈</title><meta name=Description content="陈"><meta property="og:url" content="https://blog.niubi.dev/posts/2025/03/2/">
<meta property="og:site_name" content="陈"><meta property="og:title" content="使用qcow2镜像安装debian后扩容"><meta property="og:description" content="安装所需要的命令 sudo apt update -y && sudo apt install -y parted parted 是硬盘分区工具，这里用来查看磁盘分区情况，按需删除不需要的分区，以及扩展分区容量 准备 查看磁盘空间 df -h 输出
Filesystem Size Used Avail Use% Mounted on udev 940M 0 940M 0% /dev tmpfs 198M 800K 198M 1% /run /dev/vda1 2.8G 918M 1.8G 35% / tmpfs 989M 0 989M 0% /dev/shm tmpfs 5.0M 0 5.0M 0% /run/lock /dev/vda15 127M 12M 115M 10% /boot/efi tmpfs 198M 0 198M 0% /run/user/0 可以看出我的根目录的磁盘为 /dev/vda1 只有2.8GB，所以需要对它进行扩容 我这里没有swap分区所以不需要关闭swap，但是如果开了swap需要先关闭swap 删除swap分区 关闭swap sudo swapoff -a 编辑 /etc/fstab 和 /etc/initramfs-tools/conf.d/resume 这两个文件，删除 swap 所在的行，然后更新引导配置： sudo update-initramfs -u && sudo update-grub 注意扩容成功后如果还需要swap分区需要重新添加swap分区 查看磁盘信息 注意 /dev/vda 修改你为的盘符"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-13T20:01:00+08:00"><meta property="article:modified_time" content="2025-03-13T20:01:00+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="使用qcow2镜像安装debian后扩容"><meta name=twitter:description content="安装所需要的命令 sudo apt update -y && sudo apt install -y parted parted 是硬盘分区工具，这里用来查看磁盘分区情况，按需删除不需要的分区，以及扩展分区容量 准备 查看磁盘空间 df -h 输出
Filesystem Size Used Avail Use% Mounted on udev 940M 0 940M 0% /dev tmpfs 198M 800K 198M 1% /run /dev/vda1 2.8G 918M 1.8G 35% / tmpfs 989M 0 989M 0% /dev/shm tmpfs 5.0M 0 5.0M 0% /run/lock /dev/vda15 127M 12M 115M 10% /boot/efi tmpfs 198M 0 198M 0% /run/user/0 可以看出我的根目录的磁盘为 /dev/vda1 只有2.8GB，所以需要对它进行扩容 我这里没有swap分区所以不需要关闭swap，但是如果开了swap需要先关闭swap 删除swap分区 关闭swap sudo swapoff -a 编辑 /etc/fstab 和 /etc/initramfs-tools/conf.d/resume 这两个文件，删除 swap 所在的行，然后更新引导配置： sudo update-initramfs -u && sudo update-grub 注意扩容成功后如果还需要swap分区需要重新添加swap分区 查看磁盘信息 注意 /dev/vda 修改你为的盘符"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.niubi.dev/posts/2025/03/2/><link rel=prev href=https://blog.niubi.dev/posts/2025/03/1/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"使用qcow2镜像安装debian后扩容","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.niubi.dev\/posts\/2025\/03\/2\/"},"genre":"posts","wordcount":242,"url":"https:\/\/blog.niubi.dev\/posts\/2025\/03\/2\/","datePublished":"2025-03-13T20:01:00+08:00","dateModified":"2025-03-13T20:01:00+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"陈"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=陈>陈</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=陈>陈</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">使用qcow2镜像安装debian后扩容</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>陈</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2025-03-13>2025-03-13</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 242 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 2 分钟&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#安装所需要的命令>安装所需要的命令</a></li><li><a href=#准备>准备</a></li><li><a href=#删除swap分区>删除swap分区</a></li><li><a href=#查看磁盘信息>查看磁盘信息</a></li><li><a href=#开始扩容>开始扩容</a></li><li><a href=#后续>后续</a></li></ul></nav></div></div><div class=content id=content><h2 id=安装所需要的命令>安装所需要的命令</h2><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-shell"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo apt update -y <span class=o>&amp;&amp;</span> sudo apt install -y parted</span></span></code></pre></div></div><ul><li>parted 是硬盘分区工具，这里用来查看磁盘分区情况，按需删除不需要的分区，以及扩展分区容量</li></ul><h2 id=准备>准备</h2><ol><li>查看磁盘空间</li></ol><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-shell"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>df -h</span></span></code></pre></div></div><p>输出</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><pre tabindex=0><code>Filesystem      Size  Used Avail Use% Mounted on
udev            940M     0  940M   0% /dev
tmpfs           198M  800K  198M   1% /run
/dev/vda1       2.8G  918M  1.8G  35% /
tmpfs           989M     0  989M   0% /dev/shm
tmpfs           5.0M     0  5.0M   0% /run/lock
/dev/vda15      127M   12M  115M  10% /boot/efi
tmpfs           198M     0  198M   0% /run/user/0</code></pre></div><ul><li>可以看出我的根目录的磁盘为 <code>/dev/vda1</code> 只有2.8GB，所以需要对它进行扩容</li><li>我这里没有swap分区所以不需要关闭swap，但是如果开了swap需要先关闭swap</li></ul><h2 id=删除swap分区>删除swap分区</h2><ol><li>关闭swap</li></ol><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><pre tabindex=0><code>sudo swapoff -a</code></pre></div><ol start=2><li>编辑 /etc/fstab 和 /etc/initramfs-tools/conf.d/resume 这两个文件，删除 swap 所在的行，然后更新引导配置：</li></ol><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><pre tabindex=0><code>sudo update-initramfs -u &amp;&amp; sudo update-grub</code></pre></div><ul><li>注意扩容成功后如果还需要swap分区需要重新添加swap分区</li></ul><h2 id=查看磁盘信息>查看磁盘信息</h2><blockquote><p>注意 <code>/dev/vda</code> 修改你为的盘符</p></blockquote><ol><li>进入parted工具</li></ol><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-shell"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo parted /dev/vda</span></span></code></pre></div></div><p>输出</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><pre tabindex=0><code>GNU Parted 3.5
Using /dev/vda
Welcome to GNU Parted! Type &#39;help&#39; to view a list of commands.</code></pre></div><ol start=3><li>查看磁盘信息</li></ol><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-shell"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>print /dev/vda</span></span></code></pre></div></div><p>有可能会输出这个，直接输入 Fix 回车，如果没有输出这个就忽略</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><pre tabindex=0><code>Warning: Not all of the space available to /dev/vda appears to be used, you can
fix the GPT to use all of the space (an extra 35651584 blocks) or continue with
the current setting? 
Fix/Ignore? Fix   </code></pre></div><p>输出</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><pre tabindex=0><code>Model: Virtio Block Device (virtblk)
Disk /dev/vda: 21.5GB
Sector size (logical/physical): 512B/512B
Partition Table: gpt
Disk Flags: 

Number  Start   End     Size    File system  Name  Flags
15      1049kB  134MB   133MB   fat16              boot, esp
 1      134MB   21.5GB  21.3GB  ext4</code></pre></div><ul><li>可以看出来我这里现在/dev/vda 磁盘有21GB，磁盘分区为1</li><li>不要操作 分区为 15 的盘，这个盘不能随便操作</li></ul><h2 id=开始扩容>开始扩容</h2><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><pre tabindex=0><code>resizepart 1</code></pre></div><p>输出</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><pre tabindex=0><code>Warning: Partition /dev/vda1 is being used. Are you sure you want to continue?
Yes/No? Yes </code></pre></div><ul><li>输入Yes</li></ul><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><pre tabindex=0><code>End?  [3220MB]? 21.5GB</code></pre></div><ul><li>输入 <code>print</code> 打印出来磁盘大小，就是扩容到这个磁盘的最大空间，我这里打印出来的是21.5GB</li></ul><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><pre tabindex=0><code>quit</code></pre></div><ul><li>扩容已经完成，输入 <code>quit</code> 退出</li></ul><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-shell"><span class=code-title><i class="arrow fas fa-chevron-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo resize2fs /dev/vda1</span></span></code></pre></div></div><ul><li>扩展文件系统，因为文件系统还未识别扩展的容量，所以扩展的容量还没法使用，需要扩展文件系统</li><li>这个时候可以输入 <code>df -h</code> 来查看容量</li></ul><h2 id=后续>后续</h2><p>如果还需要swap分区，就把swap分区添加进来</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2025-03-13</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/2025/03/1/ class=prev rel=prev title="utm加载qcow2镜像安装linux显示Display Output is Not Active"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>utm加载qcow2镜像安装linux显示Display Output is Not Active</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2592788502290192" crossorigin=anonymous></script></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>陈</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i></a></div><div id=fixed-buttons-hidden><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script>window.config={comment:{}}</script><script src=/js/theme.min.js></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-7EER0471GM")}</script><script src="https://www.googletagmanager.com/gtag/js?id=G-7EER0471GM" async></script></body></html>